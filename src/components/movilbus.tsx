const data = {
    "tipoasientopri": "Cama 160°",
    "tipoasientoseg": "Regular 140°",
    "servicio": "Ejecutivo vip",
    "numeroPisos": 1,
    "listaAsiento": [
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 1,
            "fila": 0,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 125.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 2,
            "fila": 0,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 125.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 3,
            "fila": 0,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 131.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 4,
            "fila": 1,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 125.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 5,
            "fila": 1,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 125.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 6,
            "fila": 1,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 131.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 7,
            "fila": 2,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 125.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 8,
            "fila": 2,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 125.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 9,
            "fila": 2,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 131.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 10,
            "fila": 3,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 125.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 11,
            "fila": 3,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 125.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 12,
            "fila": 3,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 131.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 13,
            "fila": 4,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 125.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 14,
            "fila": 4,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 125.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 15,
            "fila": 4,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 131.0,
            "tipoTarifa": 4
        },
        {
            "tipoObjeto": 5,
            "piso": 0,
            "asiento": 0,
            "fila": 5,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 0.0,
            "tipoTarifa": 0
        },
        {
            "tipoObjeto": 5,
            "piso": 0,
            "asiento": 0,
            "fila": 5,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 0.0,
            "tipoTarifa": 0
        },
        {
            "tipoObjeto": 5,
            "piso": 0,
            "asiento": 0,
            "fila": 5,
            "columna": 2,
            "estadoAsiento": 1,
            "tarifaAsiento": 0.0,
            "tipoTarifa": 0
        },
        {
            "tipoObjeto": 5,
            "piso": 0,
            "asiento": 0,
            "fila": 5,
            "columna": 3,
            "estadoAsiento": 1,
            "tarifaAsiento": 0.0,
            "tipoTarifa": 0
        },
        {
            "tipoObjeto": 5,
            "piso": 0,
            "asiento": 0,
            "fila": 5,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 0.0,
            "tipoTarifa": 0
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 16,
            "fila": 6,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 17,
            "fila": 6,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 18,
            "fila": 6,
            "columna": 3,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 19,
            "fila": 6,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 20,
            "fila": 7,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 21,
            "fila": 7,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 22,
            "fila": 7,
            "columna": 3,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 23,
            "fila": 7,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 24,
            "fila": 8,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 25,
            "fila": 8,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 26,
            "fila": 8,
            "columna": 3,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 27,
            "fila": 8,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 28,
            "fila": 9,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 29,
            "fila": 9,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 30,
            "fila": 9,
            "columna": 3,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 31,
            "fila": 9,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 32,
            "fila": 10,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 33,
            "fila": 10,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 34,
            "fila": 10,
            "columna": 3,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 35,
            "fila": 10,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 36,
            "fila": 11,
            "columna": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 0,
            "piso": 0,
            "asiento": 37,
            "fila": 11,
            "columna": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": 95.0,
            "tipoTarifa": 3
        },
        {
            "tipoObjeto": 3,
            "piso": 0,
            "asiento": 0,
            "fila": 11,
            "columna": 4,
            "estadoAsiento": 1,
            "tarifaAsiento": 0.0,
            "tipoTarifa": 0
        }
    ]
}

export function Movilbus() {
    const asientos = data.listaAsiento;
    // Agrupar por piso
    const pisos: Record<string, any[]> = {};
    let maxCol: Record<string, number> = {};
    let maxRow: Record<string, number> = {};
    asientos.forEach(a => {
        const piso = a.piso;
        if (!pisos[piso]) pisos[piso] = [];
        pisos[piso].push(a);
        const col = Number(a.columna);
        const row = Number(a.fila);
        maxCol[piso] = Math.max(maxCol[piso] || 0, col);
        maxRow[piso] = Math.max(maxRow[piso] || 0, row);
    });

    const renderAsiento = (a: any) => {
        if (a.tipoObjeto === 5) return <span style={{background:'#444',color:'#fff',padding:'2px 6px',borderRadius:4,display:'inline-block'}}>p</span>;
        if (a.tipoObjeto === 3) return <span style={{background:'#222',color:'#fff',padding:'2px 6px',borderRadius:4,display:'inline-block'}}>tv</span>;
        if (a.tipoObjeto === 0) {
            const ocupado = a.estadoAsiento === 1;
            return (
                <span style={{
                    background: ocupado ? '#e53935' : '#43a047',
                    color: '#fff',
                    padding: '2px 6px',
                    borderRadius: 4,
                    display: 'inline-block',
                    minWidth: 24,
                    textAlign: 'center',
                    opacity: ocupado ? 0.6 : 1,
                    border: ocupado ? '2px solid #b71c1c' : '2px solid #1b5e20',
                }}>
                    {a.asiento}
                </span>
            );
        }
        return null;
    };

    return (
        <div>
            <h2>Layout de bus MOVILBUS</h2>
            <div style={{ display: 'flex', gap: 32 }}>
                {Object.entries(pisos).map(([piso, asientosPiso]) => (
                    <div key={piso}>
                        <h3>Piso {piso}</h3>
                        <div style={{
                            display: 'grid',
                            gridTemplateColumns: `repeat(${maxCol[piso] + 1}, 40px)`,
                            gridTemplateRows: `repeat(${maxRow[piso] + 1}, 40px)`,
                            gap: 6,
                            background: '#222',
                            padding: 12,
                            borderRadius: 8,
                            boxShadow: '0 2px 8px #0002',
                        }}>
                            {Array.from({ length: maxRow[piso] + 1 }).map((_, yIdx) =>
                                Array.from({ length: maxCol[piso] + 1 }).map((_, xIdx) => {
                                    const asiento = asientosPiso.find(a => Number(a.columna) === xIdx && Number(a.fila) === yIdx);
                                    return (
                                        <div key={xIdx + '-' + yIdx} style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: 32 }}>
                                            {asiento ? renderAsiento(asiento) : null}
                                        </div>
                                    );
                                })
                            )}
                        </div>
                    </div>
                ))}
            </div>
            <div style={{marginTop:16}}>
                <span style={{background:'#43a047',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>Libre</span>
                <span style={{background:'#e53935',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>Ocupado</span>
                <span style={{background:'#444',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>p: Pasillo</span>
                <span style={{background:'#222',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>tv: TV</span>
            </div>
        </div>
    );
}