const data = {
    "coderror": "1",
    "entidad": [
        {
            "column": 0,
            "fare": 0,
            "floor": 1,
            "no": 51,
            "row": 1,
            "status": 0,
            "type": "51"
        },
        {
            "column": 0,
            "fare": 0,
            "floor": 1,
            "no": 0,
            "row": 2,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 0,
            "fare": 0,
            "floor": 1,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "TV"
        },
        {
            "column": 0,
            "fare": 0,
            "floor": 1,
            "no": 50,
            "row": 4,
            "status": 0,
            "type": "50"
        },
        {
            "column": 0,
            "fare": 0,
            "floor": 1,
            "no": 49,
            "row": 5,
            "status": 0,
            "type": "49"
        },
        {
            "column": 1,
            "fare": 0,
            "floor": 1,
            "no": 54,
            "row": 1,
            "status": 0,
            "type": "54"
        },
        {
            "column": 1,
            "fare": 0,
            "floor": 1,
            "no": 0,
            "row": 2,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 1,
            "fare": 0,
            "floor": 1,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 1,
            "fare": 0,
            "floor": 1,
            "no": 53,
            "row": 4,
            "status": 1,
            "type": "53"
        },
        {
            "column": 1,
            "fare": 0,
            "floor": 1,
            "no": 52,
            "row": 5,
            "status": 1,
            "type": "52"
        },
        {
            "column": 2,
            "fare": 0,
            "floor": 1,
            "no": 57,
            "row": 1,
            "status": 0,
            "type": "57"
        },
        {
            "column": 2,
            "fare": 0,
            "floor": 1,
            "no": 0,
            "row": 2,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 2,
            "fare": 0,
            "floor": 1,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 2,
            "fare": 0,
            "floor": 1,
            "no": 56,
            "row": 4,
            "status": 1,
            "type": "56"
        },
        {
            "column": 2,
            "fare": 0,
            "floor": 1,
            "no": 55,
            "row": 5,
            "status": 1,
            "type": "55"
        },
        {
            "column": 3,
            "fare": 0,
            "floor": 1,
            "no": 60,
            "row": 1,
            "status": 1,
            "type": "60"
        },
        {
            "column": 3,
            "fare": 0,
            "floor": 1,
            "no": 0,
            "row": 2,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 3,
            "fare": 0,
            "floor": 1,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 3,
            "fare": 0,
            "floor": 1,
            "no": 59,
            "row": 4,
            "status": 1,
            "type": "59"
        },
        {
            "column": 3,
            "fare": 0,
            "floor": 1,
            "no": 58,
            "row": 5,
            "status": 1,
            "type": "58"
        },
        {
            "column": 5,
            "fare": 0,
            "floor": 2,
            "no": 3,
            "row": 1,
            "status": 1,
            "type": "03"
        },
        {
            "column": 5,
            "fare": 0,
            "floor": 2,
            "no": 4,
            "row": 2,
            "status": 1,
            "type": "04"
        },
        {
            "column": 5,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "TV"
        },
        {
            "column": 5,
            "fare": 0,
            "floor": 2,
            "no": 2,
            "row": 4,
            "status": 1,
            "type": "02"
        },
        {
            "column": 5,
            "fare": 0,
            "floor": 2,
            "no": 1,
            "row": 5,
            "status": 1,
            "type": "01"
        },
        {
            "column": 6,
            "fare": 0,
            "floor": 2,
            "no": 7,
            "row": 1,
            "status": 1,
            "type": "07"
        },
        {
            "column": 6,
            "fare": 0,
            "floor": 2,
            "no": 8,
            "row": 2,
            "status": 0,
            "type": "08"
        },
        {
            "column": 6,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 6,
            "fare": 0,
            "floor": 2,
            "no": 6,
            "row": 4,
            "status": 1,
            "type": "06"
        },
        {
            "column": 6,
            "fare": 0,
            "floor": 2,
            "no": 5,
            "row": 5,
            "status": 1,
            "type": "05"
        },
        {
            "column": 7,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 1,
            "status": 0,
            "type": "EE"
        },
        {
            "column": 7,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 2,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 7,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 7,
            "fare": 0,
            "floor": 2,
            "no": 10,
            "row": 4,
            "status": 1,
            "type": "10"
        },
        {
            "column": 7,
            "fare": 0,
            "floor": 2,
            "no": 9,
            "row": 5,
            "status": 1,
            "type": "09"
        },
        {
            "column": 8,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 1,
            "status": 0,
            "type": "PU"
        },
        {
            "column": 8,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 2,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 8,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 8,
            "fare": 0,
            "floor": 2,
            "no": 12,
            "row": 4,
            "status": 1,
            "type": "12"
        },
        {
            "column": 8,
            "fare": 0,
            "floor": 2,
            "no": 11,
            "row": 5,
            "status": 1,
            "type": "11"
        },
        {
            "column": 9,
            "fare": 0,
            "floor": 2,
            "no": 15,
            "row": 1,
            "status": 1,
            "type": "15"
        },
        {
            "column": 9,
            "fare": 0,
            "floor": 2,
            "no": 16,
            "row": 2,
            "status": 0,
            "type": "16"
        },
        {
            "column": 9,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "TV"
        },
        {
            "column": 9,
            "fare": 0,
            "floor": 2,
            "no": 14,
            "row": 4,
            "status": 1,
            "type": "14"
        },
        {
            "column": 9,
            "fare": 0,
            "floor": 2,
            "no": 13,
            "row": 5,
            "status": 1,
            "type": "13"
        },
        {
            "column": 10,
            "fare": 0,
            "floor": 2,
            "no": 19,
            "row": 1,
            "status": 0,
            "type": "19"
        },
        {
            "column": 10,
            "fare": 0,
            "floor": 2,
            "no": 20,
            "row": 2,
            "status": 0,
            "type": "20"
        },
        {
            "column": 10,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 10,
            "fare": 0,
            "floor": 2,
            "no": 18,
            "row": 4,
            "status": 1,
            "type": "18"
        },
        {
            "column": 10,
            "fare": 0,
            "floor": 2,
            "no": 17,
            "row": 5,
            "status": 1,
            "type": "17"
        },
        {
            "column": 11,
            "fare": 0,
            "floor": 2,
            "no": 23,
            "row": 1,
            "status": 1,
            "type": "23"
        },
        {
            "column": 11,
            "fare": 0,
            "floor": 2,
            "no": 24,
            "row": 2,
            "status": 1,
            "type": "24"
        },
        {
            "column": 11,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 11,
            "fare": 0,
            "floor": 2,
            "no": 22,
            "row": 4,
            "status": 1,
            "type": "22"
        },
        {
            "column": 11,
            "fare": 0,
            "floor": 2,
            "no": 21,
            "row": 5,
            "status": 1,
            "type": "21"
        },
        {
            "column": 12,
            "fare": 0,
            "floor": 2,
            "no": 27,
            "row": 1,
            "status": 1,
            "type": "27"
        },
        {
            "column": 12,
            "fare": 0,
            "floor": 2,
            "no": 28,
            "row": 2,
            "status": 1,
            "type": "28"
        },
        {
            "column": 12,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 12,
            "fare": 0,
            "floor": 2,
            "no": 26,
            "row": 4,
            "status": 1,
            "type": "26"
        },
        {
            "column": 12,
            "fare": 0,
            "floor": 2,
            "no": 25,
            "row": 5,
            "status": 0,
            "type": "25"
        },
        {
            "column": 13,
            "fare": 0,
            "floor": 2,
            "no": 31,
            "row": 1,
            "status": 1,
            "type": "31"
        },
        {
            "column": 13,
            "fare": 0,
            "floor": 2,
            "no": 32,
            "row": 2,
            "status": 1,
            "type": "32"
        },
        {
            "column": 13,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "TV"
        },
        {
            "column": 13,
            "fare": 0,
            "floor": 2,
            "no": 30,
            "row": 4,
            "status": 1,
            "type": "30"
        },
        {
            "column": 13,
            "fare": 0,
            "floor": 2,
            "no": 29,
            "row": 5,
            "status": 1,
            "type": "29"
        },
        {
            "column": 14,
            "fare": 0,
            "floor": 2,
            "no": 35,
            "row": 1,
            "status": 1,
            "type": "35"
        },
        {
            "column": 14,
            "fare": 0,
            "floor": 2,
            "no": 36,
            "row": 2,
            "status": 1,
            "type": "36"
        },
        {
            "column": 14,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 14,
            "fare": 0,
            "floor": 2,
            "no": 34,
            "row": 4,
            "status": 1,
            "type": "34"
        },
        {
            "column": 14,
            "fare": 0,
            "floor": 2,
            "no": 33,
            "row": 5,
            "status": 1,
            "type": "33"
        },
        {
            "column": 15,
            "fare": 0,
            "floor": 2,
            "no": 39,
            "row": 1,
            "status": 1,
            "type": "39"
        },
        {
            "column": 15,
            "fare": 0,
            "floor": 2,
            "no": 40,
            "row": 2,
            "status": 1,
            "type": "40"
        },
        {
            "column": 15,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 15,
            "fare": 0,
            "floor": 2,
            "no": 38,
            "row": 4,
            "status": 1,
            "type": "38"
        },
        {
            "column": 15,
            "fare": 0,
            "floor": 2,
            "no": 37,
            "row": 5,
            "status": 1,
            "type": "37"
        },
        {
            "column": 16,
            "fare": 0,
            "floor": 2,
            "no": 43,
            "row": 1,
            "status": 1,
            "type": "43"
        },
        {
            "column": 16,
            "fare": 0,
            "floor": 2,
            "no": 44,
            "row": 2,
            "status": 0,
            "type": "44"
        },
        {
            "column": 16,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 16,
            "fare": 0,
            "floor": 2,
            "no": 42,
            "row": 4,
            "status": 1,
            "type": "42"
        },
        {
            "column": 16,
            "fare": 0,
            "floor": 2,
            "no": 41,
            "row": 5,
            "status": 1,
            "type": "41"
        },
        {
            "column": 17,
            "fare": 0,
            "floor": 2,
            "no": 47,
            "row": 1,
            "status": 1,
            "type": "47"
        },
        {
            "column": 17,
            "fare": 0,
            "floor": 2,
            "no": 48,
            "row": 2,
            "status": 1,
            "type": "48"
        },
        {
            "column": 17,
            "fare": 0,
            "floor": 2,
            "no": 0,
            "row": 3,
            "status": 0,
            "type": "VA"
        },
        {
            "column": 17,
            "fare": 0,
            "floor": 2,
            "no": 46,
            "row": 4,
            "status": 1,
            "type": "46"
        },
        {
            "column": 17,
            "fare": 0,
            "floor": 2,
            "no": 45,
            "row": 5,
            "status": 1,
            "type": "45"
        }
    ],
    "message": "",
    "success": true
}

export function Jelaf() {
    const asientos = data.entidad;
    // Agrupar por piso
    const pisos: Record<string, any[]> = {};
    let maxCol: Record<string, number> = {};
    let maxRow: Record<string, number> = {};
    asientos.forEach(a => {
        const piso = a.floor;
        if (!pisos[piso]) pisos[piso] = [];
        pisos[piso].push(a);
        const col = Number(a.column);
        const row = Number(a.row);
        maxCol[piso] = Math.max(maxCol[piso] || 0, col);
        maxRow[piso] = Math.max(maxRow[piso] || 0, row);
    });

    const renderAsiento = (a: any) => {
        if (a.type === 'VA') return <span style={{background:'#444',color:'#fff',padding:'2px 6px',borderRadius:4,display:'inline-block'}}>p</span>;
        if (a.type === 'TV') return <span style={{background:'#222',color:'#fff',padding:'2px 6px',borderRadius:4,display:'inline-block'}}>tv</span>;
        if (a.type === 'PU') return <span style={{background:'#388e3c',color:'#fff',padding:'2px 6px',borderRadius:4,display:'inline-block'}}>pu</span>;
        if (a.type === 'EE') return <span style={{background:'#8d5524',color:'#fff',padding:'2px 6px',borderRadius:4,display:'inline-block'}}>ee</span>;
        if (!isNaN(Number(a.type))) {
            const ocupado = a.status === 1;
            return (
                <span style={{
                    background: ocupado ? '#e53935' : '#43a047',
                    color: '#fff',
                    padding: '2px 6px',
                    borderRadius: 4,
                    display: 'inline-block',
                    minWidth: 24,
                    textAlign: 'center',
                    opacity: ocupado ? 0.6 : 1,
                    border: ocupado ? '2px solid #b71c1c' : '2px solid #1b5e20',
                }}>
                    {a.no}
                </span>
            );
        }
        return null;
    };

    return (
        <div>
            <h2>Layout de bus JELAF</h2>
            <div style={{ display: 'flex', gap: 32 }}>
                {Object.entries(pisos).map(([piso, asientosPiso]) => (
                    <div key={piso}>
                        <h3>Piso {piso}</h3>
                        <div style={{
                            display: 'grid',
                            gridTemplateColumns: `repeat(${maxCol[piso] + 1}, 40px)`,
                            gridTemplateRows: `repeat(${maxRow[piso]}, 40px)`,
                            gap: 6,
                            background: '#222',
                            padding: 12,
                            borderRadius: 8,
                            boxShadow: '0 2px 8px #0002',
                        }}>
                            {Array.from({ length: maxRow[piso] }).map((_, yIdx) =>
                                Array.from({ length: maxCol[piso] + 1 }).map((_, xIdx) => {
                                    const asiento = asientosPiso.find(a => Number(a.column) === xIdx && Number(a.row) === yIdx + 1);
                                    return (
                                        <div key={xIdx + '-' + yIdx} style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: 32 }}>
                                            {asiento ? renderAsiento(asiento) : null}
                                        </div>
                                    );
                                })
                            )}
                        </div>
                    </div>
                ))}
            </div>
            <div style={{marginTop:16}}>
                <span style={{background:'#43a047',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>Libre</span>
                <span style={{background:'#e53935',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>Ocupado</span>
                <span style={{background:'#444',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>p: Pasillo</span>
                <span style={{background:'#222',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>tv: TV</span>
                <span style={{background:'#388e3c',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>pu: Puerta</span>
                <span style={{background:'#8d5524',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>ee: Escalera</span>
            </div>
        </div>
    );
}