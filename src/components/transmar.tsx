const data = {
    "error": false,
    "errorDescripcion": null,
    "servicio": {
        "id": 4,
        "denominacion": "PREMIUM",
        "numeroPisos": 1,
        "numeroAsientosPiso1": 44,
        "numeroFilasPiso1": 12,
        "numeroColumnasPiso1": 5,
        "numeroAsientosPiso2": null,
        "numeroFilasPiso2": null,
        "numeroColumnasPiso2": null
    },
    "listMapaBus": [
        {
            "numeroAsiento": 1,
            "numeroFila": 4,
            "numeroColumna": 0,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 2,
            "numeroFila": 3,
            "numeroColumna": 0,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 0,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": null,
            "numeroFila": 2,
            "numeroColumna": 0,
            "numeroPiso": 0,
            "tipoObjeto": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": null
        },
        {
            "numeroAsiento": 3,
            "numeroFila": 1,
            "numeroColumna": 0,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 0,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 4,
            "numeroFila": 0,
            "numeroColumna": 0,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 5,
            "numeroFila": 4,
            "numeroColumna": 1,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 6,
            "numeroFila": 3,
            "numeroColumna": 1,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 7,
            "numeroFila": 1,
            "numeroColumna": 1,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 8,
            "numeroFila": 0,
            "numeroColumna": 1,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 9,
            "numeroFila": 4,
            "numeroColumna": 2,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 10,
            "numeroFila": 3,
            "numeroColumna": 2,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 11,
            "numeroFila": 1,
            "numeroColumna": 2,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 12,
            "numeroFila": 0,
            "numeroColumna": 2,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 13,
            "numeroFila": 4,
            "numeroColumna": 3,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 14,
            "numeroFila": 3,
            "numeroColumna": 3,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": null,
            "numeroFila": 2,
            "numeroColumna": 3,
            "numeroPiso": 0,
            "tipoObjeto": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": null
        },
        {
            "numeroAsiento": 15,
            "numeroFila": 1,
            "numeroColumna": 3,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 16,
            "numeroFila": 0,
            "numeroColumna": 3,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 17,
            "numeroFila": 4,
            "numeroColumna": 4,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 18,
            "numeroFila": 3,
            "numeroColumna": 4,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 19,
            "numeroFila": 1,
            "numeroColumna": 4,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 20,
            "numeroFila": 0,
            "numeroColumna": 4,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 21,
            "numeroFila": 4,
            "numeroColumna": 5,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 22,
            "numeroFila": 3,
            "numeroColumna": 5,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 25,
            "numeroFila": 4,
            "numeroColumna": 6,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 26,
            "numeroFila": 3,
            "numeroColumna": 6,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 23,
            "numeroFila": 1,
            "numeroColumna": 6,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 24,
            "numeroFila": 0,
            "numeroColumna": 6,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 29,
            "numeroFila": 4,
            "numeroColumna": 7,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 30,
            "numeroFila": 3,
            "numeroColumna": 7,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": null,
            "numeroFila": 2,
            "numeroColumna": 7,
            "numeroPiso": 0,
            "tipoObjeto": 1,
            "estadoAsiento": 1,
            "tarifaAsiento": null
        },
        {
            "numeroAsiento": 27,
            "numeroFila": 1,
            "numeroColumna": 7,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 28,
            "numeroFila": 0,
            "numeroColumna": 7,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 33,
            "numeroFila": 4,
            "numeroColumna": 8,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 34,
            "numeroFila": 3,
            "numeroColumna": 8,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 31,
            "numeroFila": 1,
            "numeroColumna": 8,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 32,
            "numeroFila": 0,
            "numeroColumna": 8,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 37,
            "numeroFila": 4,
            "numeroColumna": 9,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 38,
            "numeroFila": 3,
            "numeroColumna": 9,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 35,
            "numeroFila": 1,
            "numeroColumna": 9,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 36,
            "numeroFila": 0,
            "numeroColumna": 9,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 41,
            "numeroFila": 4,
            "numeroColumna": 10,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 42,
            "numeroFila": 3,
            "numeroColumna": 10,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 39,
            "numeroFila": 1,
            "numeroColumna": 10,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 40,
            "numeroFila": 0,
            "numeroColumna": 10,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 43,
            "numeroFila": 1,
            "numeroColumna": 11,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        },
        {
            "numeroAsiento": 44,
            "numeroFila": 0,
            "numeroColumna": 11,
            "numeroPiso": 0,
            "tipoObjeto": 0,
            "estadoAsiento": 1,
            "tarifaAsiento": 80.0
        }
    ]
}

export function Transmar() {
    const asientos = data.listMapaBus;
    // Agrupar por piso
    const pisos: Record<string, any[]> = {};
    let maxCol: Record<string, number> = {};
    let maxRow: Record<string, number> = {};
    asientos.forEach(a => {
        const piso = a.numeroPiso;
        if (!pisos[piso]) pisos[piso] = [];
        pisos[piso].push(a);
        const col = Number(a.numeroColumna);
        const row = Number(a.numeroFila);
        maxCol[piso] = Math.max(maxCol[piso] || 0, col);
        maxRow[piso] = Math.max(maxRow[piso] || 0, row);
    });

    const renderAsiento = (a: any) => {
        if (a.tipoObjeto === 1) return <span style={{background:'#444',color:'#fff',padding:'2px 6px',borderRadius:4,display:'inline-block'}}>p</span>;
        if (a.tipoObjeto === 0) {
            const ocupado = a.estadoAsiento === 1;
            return (
                <span style={{
                    background: ocupado ? '#e53935' : '#43a047',
                    color: '#fff',
                    padding: '2px 6px',
                    borderRadius: 4,
                    display: 'inline-block',
                    minWidth: 24,
                    textAlign: 'center',
                    opacity: ocupado ? 0.6 : 1,
                    border: ocupado ? '2px solid #b71c1c' : '2px solid #1b5e20',
                }}>
                    {a.numeroAsiento}
                </span>
            );
        }
        return null;
    };

    return (
        <div>
            <h2>Layout de bus TRANSMAR</h2>
            <div style={{ display: 'flex', gap: 32 }}>
                {Object.entries(pisos).map(([piso, asientosPiso]) => (
                    <div key={piso}>
                        <h3>Piso {piso}</h3>
                        <div style={{
                            display: 'grid',
                            gridTemplateColumns: `repeat(${maxCol[piso] + 1}, 40px)`,
                            gridTemplateRows: `repeat(${maxRow[piso] + 1}, 40px)`,
                            gap: 6,
                            background: '#222',
                            padding: 12,
                            borderRadius: 8,
                            boxShadow: '0 2px 8px #0002',
                        }}>
                            {Array.from({ length: maxRow[piso] + 1 }).map((_, yIdx) =>
                                Array.from({ length: maxCol[piso] + 1 }).map((_, xIdx) => {
                                    const asiento = asientosPiso.find(a => Number(a.numeroColumna) === xIdx && Number(a.numeroFila) === yIdx);
                                    return (
                                        <div key={xIdx + '-' + yIdx} style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: 32 }}>
                                            {asiento ? renderAsiento(asiento) : null}
                                        </div>
                                    );
                                })
                            )}
                        </div>
                    </div>
                ))}
            </div>
            <div style={{marginTop:16}}>
                <span style={{background:'#43a047',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>Libre</span>
                <span style={{background:'#e53935',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>Ocupado</span>
                <span style={{background:'#444',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>p: Pasillo</span>
            </div>
        </div>
    );
}