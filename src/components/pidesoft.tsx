const data = {
    "status": true,
    "data": {
        "bus_id": "ae753fd976cf6be1a6b48eeed4501d4d8c1ff7bf8e808c50d3677a6741b1c18872159b2a1aede8ecdbee352df4535a424308788a057fa4caf73d1aeeae78f8c2",
        "asientos": [
            {
                "tipo": "asiento",
                "numero": "1",
                "fila": 1,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 40
            },
            {
                "tipo": "asiento",
                "numero": "2",
                "fila": 1,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 40
            },
            {
                "tipo": "pasillo",
                "fila": 1,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "3",
                "fila": 1,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 40
            },
            {
                "tipo": "asiento",
                "numero": "4",
                "fila": 1,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 40
            },
            {
                "tipo": "asiento",
                "numero": "5",
                "fila": 2,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "6",
                "fila": 2,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 2,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "7",
                "fila": 2,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "8",
                "fila": 2,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "9",
                "fila": 3,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "10",
                "fila": 3,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 3,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "11",
                "fila": 3,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "12",
                "fila": 3,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "13",
                "fila": 4,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "14",
                "fila": 4,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 4,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "pasillo",
                "fila": 4,
                "columna": 4,
                "piso": 2
            },
            {
                "tipo": "pasillo",
                "fila": 4,
                "columna": 5,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "15",
                "fila": 5,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "16",
                "fila": 5,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 5,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "pasillo",
                "fila": 5,
                "columna": 4,
                "piso": 2
            },
            {
                "tipo": "pasillo",
                "fila": 5,
                "columna": 5,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "17",
                "fila": 6,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "18",
                "fila": 6,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 6,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "pasillo",
                "fila": 6,
                "columna": 4,
                "piso": 2
            },
            {
                "tipo": "pasillo",
                "fila": 6,
                "columna": 5,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "21",
                "fila": 7,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "22",
                "fila": 7,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 7,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "19",
                "fila": 7,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 40
            },
            {
                "tipo": "asiento",
                "numero": "20",
                "fila": 7,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 40
            },
            {
                "tipo": "asiento",
                "numero": "25",
                "fila": 8,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "26",
                "fila": 8,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 8,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "23",
                "fila": 8,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "24",
                "fila": 8,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "29",
                "fila": 9,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "30",
                "fila": 9,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 9,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "27",
                "fila": 9,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "28",
                "fila": 9,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "33",
                "fila": 10,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "34",
                "fila": 10,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 10,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "31",
                "fila": 10,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "32",
                "fila": 10,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "37",
                "fila": 11,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "38",
                "fila": 11,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 11,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "35",
                "fila": 11,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "36",
                "fila": 11,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "41",
                "fila": 12,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "42",
                "fila": 12,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 12,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "39",
                "fila": 12,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "40",
                "fila": 12,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "45",
                "fila": 13,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "46",
                "fila": 13,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 13,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "43",
                "fila": 13,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "44",
                "fila": 13,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "49",
                "fila": 14,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "50",
                "fila": 14,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "pasillo",
                "fila": 14,
                "columna": 3,
                "piso": 2
            },
            {
                "tipo": "asiento",
                "numero": "47",
                "fila": 14,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "48",
                "fila": 14,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "53",
                "fila": 15,
                "columna": 1,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "54",
                "fila": 15,
                "columna": 2,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "55",
                "fila": 15,
                "columna": 3,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "51",
                "fila": 15,
                "columna": 4,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "52",
                "fila": 15,
                "columna": 5,
                "piso": 2,
                "disponible": true,
                "tarifa": 30
            },
            {
                "tipo": "asiento",
                "numero": "56",
                "fila": 1,
                "columna": 1,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "asiento",
                "numero": "57",
                "fila": 1,
                "columna": 2,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "pasillo",
                "fila": 1,
                "columna": 3,
                "piso": 1
            },
            {
                "tipo": "pasillo",
                "fila": 1,
                "columna": 4,
                "piso": 1
            },
            {
                "tipo": "asiento",
                "numero": "58",
                "fila": 1,
                "columna": 5,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "asiento",
                "numero": "59",
                "fila": 2,
                "columna": 1,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "asiento",
                "numero": "60",
                "fila": 2,
                "columna": 2,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "pasillo",
                "fila": 2,
                "columna": 3,
                "piso": 1
            },
            {
                "tipo": "pasillo",
                "fila": 2,
                "columna": 4,
                "piso": 1
            },
            {
                "tipo": "asiento",
                "numero": "61",
                "fila": 2,
                "columna": 5,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "asiento",
                "numero": "62",
                "fila": 3,
                "columna": 1,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "asiento",
                "numero": "63",
                "fila": 3,
                "columna": 2,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "pasillo",
                "fila": 3,
                "columna": 3,
                "piso": 1
            },
            {
                "tipo": "pasillo",
                "fila": 3,
                "columna": 4,
                "piso": 1
            },
            {
                "tipo": "asiento",
                "numero": "64",
                "fila": 3,
                "columna": 5,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "asiento",
                "numero": "65",
                "fila": 4,
                "columna": 1,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "asiento",
                "numero": "66",
                "fila": 4,
                "columna": 2,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            },
            {
                "tipo": "pasillo",
                "fila": 4,
                "columna": 3,
                "piso": 1
            },
            {
                "tipo": "pasillo",
                "fila": 4,
                "columna": 4,
                "piso": 1
            },
            {
                "tipo": "asiento",
                "numero": "67",
                "fila": 4,
                "columna": 5,
                "piso": 1,
                "disponible": true,
                "tarifa": 50
            }
        ]
    }
}

export function Pidesoft() {
    const asientos = data.data.asientos;
    // Agrupar por piso
    const pisos: Record<string, any[]> = {};
    let maxCol: Record<string, number> = {};
    let maxRow: Record<string, number> = {};
    asientos.forEach(a => {
        const piso = a.piso;
        if (!pisos[piso]) pisos[piso] = [];
        pisos[piso].push(a);
        const col = Number(a.columna);
        const row = Number(a.fila);
        maxCol[piso] = Math.max(maxCol[piso] || 0, col);
        maxRow[piso] = Math.max(maxRow[piso] || 0, row);
    });

    const renderAsiento = (a: any) => {
        if (a.tipo === 'pasillo') return <span style={{background:'#444',color:'#fff',padding:'2px 6px',borderRadius:4,display:'inline-block'}}>p</span>;
        if (a.tipo === 'asiento') {
            const ocupado = a.disponible === false;
            return (
                <span style={{
                    background: ocupado ? '#e53935' : '#43a047',
                    color: '#fff',
                    padding: '2px 6px',
                    borderRadius: 4,
                    display: 'inline-block',
                    minWidth: 24,
                    textAlign: 'center',
                    opacity: ocupado ? 0.6 : 1,
                    border: ocupado ? '2px solid #b71c1c' : '2px solid #1b5e20',
                }}>
                    {a.numero}
                </span>
            );
        }
        return null;
    };

    return (
        <div>
            <h2>Layout de bus PIDESOFT</h2>
            <div style={{ display: 'flex', gap: 32 }}>
                {Object.entries(pisos).map(([piso, asientosPiso]) => (
                    <div key={piso}>
                        <h3>Piso {piso}</h3>
                        <div style={{
                            display: 'grid',
                            gridTemplateColumns: `repeat(${maxCol[piso]}, 40px)`,
                            gridTemplateRows: `repeat(${maxRow[piso]}, 40px)`,
                            gap: 6,
                            background: '#222',
                            padding: 12,
                            borderRadius: 8,
                            boxShadow: '0 2px 8px #0002',
                        }}>
                            {Array.from({ length: maxRow[piso] }).map((_, yIdx) =>
                                Array.from({ length: maxCol[piso] }).map((_, xIdx) => {
                                    const asiento = asientosPiso.find(a => Number(a.columna) === xIdx + 1 && Number(a.fila) === yIdx + 1);
                                    return (
                                        <div key={xIdx + '-' + yIdx} style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: 32 }}>
                                            {asiento ? renderAsiento(asiento) : null}
                                        </div>
                                    );
                                })
                            )}
                        </div>
                    </div>
                ))}
            </div>
            <div style={{marginTop:16}}>
                <span style={{background:'#43a047',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>Libre</span>
                <span style={{background:'#e53935',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>Ocupado</span>
                <span style={{background:'#444',color:'#fff',padding:'2px 6px',borderRadius:4,marginRight:8}}>p: Pasillo</span>
            </div>
        </div>
    );
}